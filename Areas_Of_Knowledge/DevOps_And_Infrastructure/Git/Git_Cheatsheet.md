# Areas_Of_Knowledge\DevOps_And_Infrastructure\Git\Git_Cheatsheet.md

# Git 完全速查表

## 目录

- [Areas\_Of\_Knowledge\\DevOps\_And\_Infrastructure\\Git\\Git\_Cheatsheet.md](#areas_of_knowledgedevops_and_infrastructuregitgit_cheatsheetmd)
- [Git 完全速查表](#git-完全速查表)
  - [目录](#目录)
    - [1. Git 核心概念与工作流](#1-git-核心概念与工作流)
      - [1.1. 四个工作区域](#11-四个工作区域)
      - [1.2. 基本工作流程](#12-基本工作流程)
    - [2. 基础配置](#2-基础配置)
      - [2.1. 设置用户信息](#21-设置用户信息)
      - [2.2. 检查配置信息](#22-检查配置信息)
    - [3. 创建与克隆仓库](#3-创建与克隆仓库)
      - [3.1. 初始化新仓库](#31-初始化新仓库)
      - [3.2. 克隆现有仓库](#32-克隆现有仓库)
    - [4. 本地修改与提交](#4-本地修改与提交)
      - [4.1. 查看状态](#41-查看状态)
      - [4.2. 添加到暂存区](#42-添加到暂存区)
      - [4.3. 提交到本地仓库](#43-提交到本地仓库)
      - [4.4. 查看差异](#44-查看差异)
      - [4.5. 忽略文件 (.gitignore)](#45-忽略文件-gitignore)
    - [5. 查看历史与状态](#5-查看历史与状态)
      - [5.1. 查看提交历史 (git log)](#51-查看提交历史-git-log)
      - [5.2. 查看单次提交详情](#52-查看单次提交详情)
    - [6. 分支管理](#6-分支管理)
      - [6.1. 创建与切换分支](#61-创建与切换分支)
      - [6.2. 合并与变基](#62-合并与变基)
      - [6.3. 删除分支](#63-删除分支)
    - [7. 远程仓库操作](#7-远程仓库操作)
      - [7.1. 管理远程仓库](#71-管理远程仓库)
      - [7.2. 与远程仓库同步](#72-与远程仓库同步)
    - [8. 标签 (Tag)](#8-标签-tag)
      - [8.1. 创建标签](#81-创建标签)
      - [8.2. 查看与删除标签](#82-查看与删除标签)
      - [8.3. 共享标签](#83-共享标签)
    - [9. 撤销与回退](#9-撤销与回退)
      - [9.1. 撤销工作区修改](#91-撤销工作区修改)
      - [9.2. 取消暂存](#92-取消暂存)
      - [9.3. 回退版本 (reset vs revert)](#93-回退版本-reset-vs-revert)
    - [10. 暂存 (Stash)](#10-暂存-stash)
    - [11. Cherry-Pick](#11-cherry-pick)

***

### 1. Git 核心概念与工作流

#### 1.1. 四个工作区域

*   **工作区 (Workspace)**：您在电脑上能看到的项目目录，是进行代码编写和修改的直接场所。
*   **暂存区 (Staging Area / Index)**：一个位于 `.git` 目录下的文件，它像一个购物车的列表，记录了您通过 `git add` 命令标记的、准备在下一次提交中包含的变更。这使得您可以精确控制每次提交的内容。
*   **本地仓库 (Local Repository)**：项目所有版本历史的完整副本，存放在项目根目录下的 `.git` 文件夹内。您的每一次 `git commit` 都是在向这里提交记录。
*   **远程仓库 (Remote Repository)**：托管在网络服务器（如 GitHub, GitLab）上的项目仓库，是团队协作和数据备份的中心。

#### 1.2. 基本工作流程

一个典型的本地工作流程如下：
1.  在 **工作区** 修改文件。
2.  使用 `git add` 将想要提交的修改放入 **暂存区**。
3.  使用 `git commit` 将 **暂存区** 的内容永久记录到 **本地仓库**。
4.  （协作时）使用 `git push` 将 **本地仓库** 的提交同步到 **远程仓库**。

### 2. 基础配置

首次使用 Git 时，或在新机器上，需要配置您的身份信息。这些信息会嵌入到您的每一次提交中。

#### 2.1. 设置用户信息

| 命令 | 解释 |
| --- | --- |
| `git config --global user.name "[name]"` | 设置全局用户名。所有仓库默认使用此用户名。 |
| `git config --global user.email "[email address]"` | 设置全局用户邮箱。所有仓库默认使用此邮箱。 |
| `git config --local user.name "[name]"` | 仅为当前仓库设置用户名，覆盖全局配置。 |

#### 2.2. 检查配置信息

| 命令 | 解释 |
| --- | --- |
| `git config --list` | 查看所有配置信息（包括本地、全局和系统）。 |
| `git config user.name` | 查看当前生效的用户名。 |

### 3. 创建与克隆仓库

#### 3.1. 初始化新仓库

| 命令 | 解释 |
| --- | --- |
| `git init` | 在当前目录初始化一个新的 Git 仓库，会创建一个 `.git` 文件夹。 |
| `git init [project-name]` | 新建一个名为 `project-name` 的目录，并将其初始化为 Git 仓库。 |

#### 3.2. 克隆现有仓库

| 命令 | 解释 |
| --- | --- |
| `git clone [url]` | 克隆一个远程仓库到本地当前目录。 |
| `git clone [url] [directory-name]` | 克隆远程仓库到本地指定名称的目录。 |
| `git clone -b [branch-name] [url]` | 克隆远程仓库，并直接检出指定的分支。 |

### 4. 本地修改与提交

这是日常开发中最频繁使用的操作。

#### 4.1. 查看状态

| 命令 | 解释 |
| --- | --- |
| `git status` | 查看当前工作区和暂存区的状态，会列出已修改、已暂存和未跟踪的文件。 |
| `git status -s` | 以简短的格式输出状态信息，更紧凑。 |

#### 4.2. 添加到暂存区

| 命令 | 解释 |
| --- | --- |
| `git add [file]` | 将指定文件的修改添加到暂存区。 |
| `git add [dir]/` | 将指定目录下的所有修改添加到暂存区。 |
| `git add .` | 将当前目录下所有已修改或新创建的文件添加到暂存区（**不包括被删除的文件**）。 |
| `git add -u` | 将所有已跟踪的文件的修改（**包括被删除的文件**）添加到暂存区。 |
| `git add -A` | `add .` 和 `add -u` 的并集，暂存所有变更。 |

#### 4.3. 提交到本地仓库

| 命令 | 解释 |
| --- | --- |
| `git commit -m "[message]"` | 将暂存区的文件提交到本地仓库，并附上单行提交信息。 |
| `git commit` | 不带 `-m` 选项，会打开默认文本编辑器让您输入更详细的提交信息。 |
| `git commit -a -m "[message]"` | 跳过 `git add`，直接将所有**已跟踪过**的文件的修改暂存并提交。 |
| `git commit --amend` | 修改最后一次的提交。可用于修改提交信息或追加新的改动。<br>**警告**：如果该提交已推送到远程仓库，请谨慎使用此命令，因为它会改写历史。 |

#### 4.4. 查看差异

| 命令 | 解释 |
| --- | --- |
| `git diff` | 查看 **工作区** 与 **暂存区** 之间的差异。 |
| `git diff --staged` 或 `git diff --cached` | 查看 **暂存区** 与 **上次提交 (HEAD)** 之间的差异。 |
| `git diff HEAD` | 查看 **工作区** 与 **上次提交** 之间的差异（包含已暂存和未暂存的改动）。 |
| `git diff [commit-id1] [commit-id2]` | 查看两次提交之间的差异。 |

#### 4.5. 忽略文件 (.gitignore)

在项目根目录创建一个名为 `.gitignore` 的文件，将不需要 Git 跟踪的文件或目录模式写入其中，例如日志文件、编译产物等。

```gitignore
# 忽略 .log 文件
*.log

# 忽略 build 目录
build/

# 忽略特定的配置文件
/config.local.js
```

### 5. 查看历史与状态

#### 5.1. 查看提交历史 (git log)

| 命令 | 解释 |
| --- | --- |
| `git log` | 查看详细的提交历史。 |
| `git log --oneline` | 以单行格式显示提交历史，更简洁。 |
| `git log --graph` | 以图形化方式显示分支合并历史。 |
| `git log --oneline --graph --decorate --all` | 一个非常实用的组合，查看所有分支的图形化历史。 |
| `git log -p -2` | 显示最近两次提交的详细差异（patch）。 |
| `git log --author="[name]"` | 按作者筛选提交历史。 |

#### 5.2. 查看单次提交详情

| 命令 | 解释 |
| --- | --- |
| `git show [commit-id]` | 显示某次提交的元数据（作者、日期等）和详细的代码变更。 |
| `git show HEAD` | 显示最新一次提交的详情。`HEAD~1` 表示倒数第二次。 |

### 6. 分支管理

分支是 Git 的核心功能，允许多人并行开发而互不干扰。

#### 6.1. 创建与切换分支

| 命令 | 解释 |
| --- | --- |
| `git branch` | 查看所有本地分支，当前分支会以 `*` 标记。 |
| `git branch -a` | 查看所有本地分支和远程跟踪分支。 |
| `git branch [branch-name]` | 创建一个名为 `branch-name` 的新分支。 |
| `git checkout [branch-name]` | 切换到指定分支。 |
| `git checkout -b [branch-name]` | 创建并立即切换到新的分支（`branch` 和 `checkout` 的合并）。 |

**现代命令 (Git 2.23+):**
| 命令 | 解释 |
| --- | --- |
| `git switch [branch-name]` | 切换到指定分支（功能更专一）。 |
| `git switch -c [branch-name]` | 创建并切换到新分支（`checkout -b` 的替代）。 |

#### 6.2. 合并与变基

| 命令 | 解释 |
| --- | --- |
| `git merge [branch-name]` | 将 `branch-name` 分支的历史合并到当前分支，会产生一个合并提交。 |
| `git rebase [branch-name]` | 将当前分支的提交“变基”到 `branch-name` 之上，使提交历史保持线性。 |

**Merge vs. Rebase**:
*   `merge`：保留了真实的分支历史，但可能会使历史图谱变得复杂。
*   `rebase`：重写提交历史，使历史记录非常整洁（一条直线）。
*   **黄金法则**：永远不要对已经推送到公共远程仓库的分支执行 `rebase` 操作，这会给协作者带来麻烦。

#### 6.3. 删除分支

| 命令 | 解释 |
| --- | --- |
| `git branch -d [branch-name]` | 删除一个已经完全合并的本地分支。 |
| `git branch -D [branch-name]` | 强制删除一个本地分支，即使它还没有被合并。 |
| `git push origin --delete [branch-name]` | 删除一个远程仓库上的分支。 |

### 7. 远程仓库操作

#### 7.1. 管理远程仓库

| 命令 | 解释 |
| --- | --- |
| `git remote -v` | 查看已配置的远程仓库地址。 |
| `git remote add [shortname] [url]` | 添加一个新的远程仓库，通常 `shortname` 为 `origin`。 |
| `git remote show [remote-name]` | 查看指定远程仓库的详细信息（如跟踪的分支）。 |
| `git remote rename [old-name] [new-name]` | 重命名一个远程仓库。 |
| `git remote remove [remote-name]` | 移除一个远程仓库。 |

#### 7.2. 与远程仓库同步

| 命令 | 解释 |
| --- | --- |
| `git fetch [remote-name]` | 从远程仓库下载最新的对象和引用，但**不会**自动合并到本地工作分支。这是一个安全的操作。 |
| `git pull [remote-name] [branch-name]` | 从远程仓库拉取最新代码并与本地分支合并。相当于 `git fetch` + `git merge`。 |
| `git pull --rebase` | 使用 `rebase` 代替 `merge` 来合并远程变更，保持历史线性。 |
| `git push [remote-name] [branch-name]` | 将本地分支的提交推送到远程仓库。 |
| `git push -u origin [branch-name]` | 首次推送时使用，建立本地分支与远程分支的跟踪关系。 |

### 8. 标签 (Tag)

标签用于标记项目历史中的重要节点，如 `v1.0` 这样的版本发布。

#### 8.1. 创建标签

| 命令 | 解释 |
| --- | --- |
| `git tag [tag-name]` | 在当前提交上创建一个轻量标签。 |
| `git tag -a [tag-name] -m "[message]"` | 创建一个带注解的标签，包含作者、日期和消息，是推荐的做法。 |

#### 8.2. 查看与删除标签

| 命令 | 解释 |
| --- | --- |
| `git tag` | 列出所有本地标签。 |
| `git show [tag-name]` | 查看标签信息和对应的提交详情。 |
| `git tag -d [tag-name]` | 删除一个本地标签。 |

#### 8.3. 共享标签

| 命令 | 解释 |
| --- | --- |
| `git push origin [tag-name]` | 将指定的本地标签推送到远程仓库。 |
| `git push --tags` | 将所有本地尚未推送的标签一次性推送到远程仓库。 |
| `git push origin --delete [tag-name]` | 删除一个远程标签。 |

### 9. 撤销与回退

#### 9.1. 撤销工作区修改

| 命令 | 解释 |
| --- | --- |
| `git checkout -- [file]` | （旧命令）撤销对工作区单个文件的修改，恢复到最近一次提交或暂存的状态。 |
| `git restore [file]` | （新命令）功能同上，更清晰。 |

#### 9.2. 取消暂存

| 命令 | 解释 |
| --- | --- |
| `git reset HEAD [file]` | （旧命令）将文件从暂存区移出，但保留工作区的修改。 |
| `git restore --staged [file]` | （新命令）功能同上，更清晰。 |

#### 9.3. 回退版本 (reset vs revert)

| 命令 | 解释 |
| --- | --- |
| `git reset --soft [commit-id]` | 回退到指定版本，**保留**工作区和暂存区的修改。 |
| `git reset --mixed [commit-id]` | （默认模式）回退到指定版本，**保留**工作区的修改，但**清空**暂存区。 |
| `git reset --hard [commit-id]` | **危险操作**：彻底回退到指定版本，工作区和暂存区的所有改动都会被**丢弃**。 |
| `git revert [commit-id]` | 创建一个新的提交来撤销指定提交的变更。这是一种**更安全**的回退方式，因为它不会改写历史。 |

### 10. 暂存 (Stash)

当你需要临时切换分支处理紧急任务，但又不想提交当前未完成的工作时，`stash` 非常有用。

| 命令 | 解释 |
| --- | --- |
| `git stash` 或 `git stash save "[message]"` | 将当前工作区的修改（默认不包括未跟踪的文件）暂存起来。 |
| `git stash -u` | 暂存时包含未被跟踪的新文件。 |
| `git stash list` | 查看所有暂存的列表。 |
| `git stash apply` | 恢复最近一次的暂存，但**不会**从暂存列表中删除它。 |
| `git stash pop` | 恢复最近一次的暂存，并**从暂存列表中删除**它。 |
| `git stash drop` | 删除最近一次的暂存。 |

### 11. Cherry-Pick

`cherry-pick` 可以选择性地将单个或多个提交从一个分支“摘取”过来，应用到当前分支，并生成新的提交。

| 命令 | 解释 |
| --- | --- |
| `git cherry-pick [commit-id]` | 将指定的提交应用到当前分支。 |
| `git cherry-pick [commit-A]..[commit-B]` | 将从 A 到 B 的所有提交（不包括 A）应用到当前分支。 |